---
title: 无标题文档
urlname: gtagx5eoumgtvf0d
date: '2024-05-24 15:48:21'
updated: '2024-05-24 16:06:24'
description: 明白了，从23题开始重写，确保Mermaid图表符合Markdown格式。七、Redis 缓存设计23. 如何避免缓存雪崩、缓存击穿、缓存穿透？回答：缓存雪崩： 原因：大量缓存同时过期，导致大量请求直接打到数据库，造成数据库压力过大。解决方案： 设置不同的缓存过期时间以错开缓存过期时间。在缓存...
---
### 明白了，从23题开始重写，确保Mermaid图表符合Markdown格式。

### 七、Redis 缓存设计

#### 23. **如何避免缓存雪崩、缓存击穿、缓存穿透？**

**回答**：

- **缓存雪崩**： 
   - **原因**：大量缓存同时过期，导致大量请求直接打到数据库，造成数据库压力过大。
   - **解决方案**： 
      - 设置不同的缓存过期时间以错开缓存过期时间。
      - 在缓存过期前主动更新缓存，使用定时任务刷新缓存。
      - 使用锁机制，限制同时访问数据库的请求数量。


- **缓存击穿**： 
   - **原因**：某些热点数据在缓存过期后，瞬间有大量请求访问，导致请求直接打到数据库。
   - **解决方案**： 
      - 热点数据设置为永不过期，并使用后台线程定时更新缓存。
      - 使用互斥锁或分布式锁，控制同时访问数据库的请求数量。


- **缓存穿透**： 
   - **原因**：请求的数据在缓存和数据库中都不存在，导致请求直接打到数据库，可能被恶意利用进行攻击。
   - **解决方案**： 
      - 使用布隆过滤器，拦截非法请求。
      - 缓存空值，将不存在的数据缓存一段时间，防止频繁访问数据库。


#### 24. **如何设计一个缓存策略，可以动态缓存热点数据？**

**回答**：

设计一个缓存策略，以动态缓存热点数据，可以考虑以下几点：

1.  **热点数据检测**： 
   - 使用滑动窗口统计或实时监控请求频率，识别热点数据。
   - 当某个数据的访问频率超过阈值时，将其标记为热点数据。
2.  **缓存预热**： 
   - 在系统启动或流量高峰前，预先将热点数据加载到缓存中。
   - 使用后台线程定时更新热点数据，避免缓存失效。
3.  **动态调整**： 
   - 根据访问频率动态调整缓存容量，增加热点数据的缓存空间。
   - 对于访问频率下降的数据，减少缓存空间或从缓存中移除。

展示动态缓存热点数据的策略：


#### 25. **说说常见的缓存更新策略？**

**回答**：

常见的缓存更新策略主要有以下几种：

1.  **定时更新（Time-based Refresh）**： 
   - 定时刷新缓存，定期从数据库中获取最新数据，更新缓存。
   - 优点：缓存数据定时更新，保证数据的新鲜度。
   - 缺点：可能会导致短暂的不一致性，尤其在定时器触发前的数据更新。
2.  **失效更新（Cache Invalidation）**： 
   - 数据库更新时，主动删除或更新对应的缓存。
   - 优点：确保缓存数据与数据库数据的一致性。
   - 缺点：实现复杂，需要在数据库更新时同步更新缓存。
3.  **主动更新（Write-through/Write-back）**： 
   - Write-through：写操作同时更新数据库和缓存。
   - Write-back：写操作先更新缓存，定期将缓存数据同步到数据库。
   - 优点：Write-through确保数据一致性；Write-back提高写操作性能。
   - 缺点：Write-through的写操作性能较低；Write-back可能导致数据不一致。

展示常见的缓存更新策略：
